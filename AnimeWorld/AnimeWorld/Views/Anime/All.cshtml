@model AllAnimesQueryModel

<section class="product-page spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="product__page__content">
                    <div class="product__page__title">
                        <form>
                            <div class="row">
                                <div class="row">
                                    <div class="col-lg-3 col-md-2 col-sm-2">
                                        <div class="product__page__filter">
                                            <label class="text-right" asp-for="TypeId"></label>
                                            <select asp-for="TypeId">
                                                <option value="0">All</option>
                                                @foreach (var type in Model.Types)
                                                { 
                                                    <option value="@type.Id">@type.Name</option>
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-2 col-sm-2">
                                        <div class="product__page__filter">
                                            <label asp-for="GenreId"></label>
                                            <select asp-for="GenreId">
                                                <option value="0">All</option>
                                                @foreach (var genre in Model.Genres)
                                                {
                                                    <option value="@genre.Id">@genre.Name</option>
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-2 col-sm-2">
                                        <div class="product__page__filter">
                                            <label asp-for="Sorting">Order by:</label>
                                            <select asp-for="Sorting">
                                                <option value="0">Newest</option>
                                                <option value="1">A-Z</option>
                                                <option value="2">Views</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-8 col-md-8 col-sm-6">
                                        <div class="product__page__filter offset-2">
                                            <label asp-for="SearchTerm"></label>
                                            <input asp-for="SearchTerm" />
                                        </div>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary h-50 search-button">Add</button>
                            </div>
                        </form>
                    </div>
                    <div class="row">
                        @foreach (var anime in Model.Animes)
                        {
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="product__item">
                    <div class="product__item__pic set-bg" data-setbg='@anime.ImageURL'>
                        <div class="ep">@anime.Epizodes</div>
                        <div class="comment"><i class="fa fa-comments"></i>@anime.Comments</div>
                        <div class="view"><i class="fa fa-eye"></i>@anime.Views</div>
                    </div>
                    <div class="product__item__text">
                        <ul>
                            <li>@anime.GenreName</li>
                            <li>@anime.TypeName</li>
                        </ul>
                        <h5><a href="#">@anime.NameJPN@(anime.NameEN == null ? "" : " / " + anime.NameEN)</a></h5>
                    </div>
                </div>
            </div>}
                    </div>
                </div>
                @{ var previousPage = Model.CurrentPage - 1;
                                if (previousPage < 1)
                                {
                                    previousPage = 1;
                                }

                                var maxPage = Math.Ceiling((double)Model.TotalAnimes / AllAnimesQueryModel.AnimesPerPage);
                    }
            <div class="product__pagination">
                @for (int i = 1; i <= maxPage; i++)
                {
            <a asp-controller="Anime"
               asp-action="All"
               asp-route-CurrentPage="@i"
               asp-route-TypeId="@Model.TypeId"
               asp-route-GenreId="@Model.GenreId"
               asp-route-Sorting="@Model.Sorting"
               asp-route-SearchTerm="@Model.SearchTerm"
               class="@(Model.CurrentPage == i ? "current-page" : "")">@i</a>
               }
               @if (!(Model.CurrentPage == maxPage))
               {
                   <a asp-controller="Anime"
                      asp-action="All"
                      asp-route-CurrentPage="@maxPage"
                      asp-route-TypeId="@Model.TypeId"
                      asp-route-GenreId="@Model.GenreId"
                      asp-route-Sorting="@Model.Sorting"
                      asp-route-SearchTerm="@Model.SearchTerm"><i class="fa fa-angle-double-right"></i></a>
               }
            </div>
            </div>
            <partial name="_AnimeTopViewsPartial" />
        </div>
    </div>
</section>
